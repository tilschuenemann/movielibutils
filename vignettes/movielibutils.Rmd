---
title: "movielibutils"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{movielibutils}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>"
)
```

```{r setup}
library(movielibutils)
```

## Introduction

This package was created to help users fetch metadata about movies using the TMDB API.

## Functions

**This is currently changing. I am removing the single use case functions in favor a generic wrapper.**

For easier implementation I've decided to built a single function to get the TMDB id, details,
cast and crew. For each of these functions exists a wrapper function to work with lists.

|single|batch|
|:---|:---|
|get_id|id_list|
|get_credits|cast_crew_list|
|get_details|details_list|
|-|get_genres|

### create_masterlist(wd, convention, api_key)

This is top-level function of this package and should be your go-to in case you need a fast way to get every detail.

**Every movie can have multiple genre_ids and production_companies. These multiply every set of rows so that there can be one master dataframe with all the data.**

The resulting dataframe looks like this. Movie details are prefixed "m_", cast and crew columns are prefixed with "cc_".

**TODO insert master table col**

### extract_names(name_vector, convention)

This function extracts metadata (title, year, opt. subtitles) according to the chosen naming convention into a dataframe and returns it. 

### id_list(title_col, year_col, id_col, api_key)

Looks up the supplied movies **TMDB ID** using the TMDB API. Supply year for more precise results - otherwise year = NULL is also ok.
The id_col parameter adds an user-supplied identifier to the returning dataframe for later joins.

If multiple matches are found for the parameters the title with the highest popularity is chosen.

### get_genres(api_key)

This function returns a dataframe containing TMDB genre ids and their respective name.

### get_details(tmdb_id, api_key) 

Looks up the movies details. Returns the following dataframe:

**TODO insert detail table col**

### details_list(id_list, api_key) 

Wraps get_details() to work with lists. 

### get_credits(tmdb_id, api_key) 

Looks up the cast and crew for a given TMDB id. Returns the following dataframe:
**TODO insert cast and crew table col**

### cast_crew_list(id_col, api_key) 

Wrapper for get_credits().

## Convention (Naming Conventions)

For extract_names() the convention parameter needs to be supplied.
Currently there four different conventions supported:

1. "1999 - The Matrix"
2. "(1999) The Matrix"
3. "The Matrix (1999)"
4. "The Matrix (1999) (OmU)"

If you use a naming convention that is reasonable and not supported yet, feel free to submit a pull request on [Github](https://github.com/tilschuenemann/movielibutils/pulls).
